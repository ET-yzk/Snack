这是大一时候的数据结构大作业，一个简单的基于 EasyX 的图形化贪吃蛇小游戏，带了一个简单的寻路算法机器🐍。

其中还保留了借鉴的代码文件和其他文件，最终运行的代码为 main.cpp。

**大作业报告部分内容：**

**1．** **问题描述**：启发式智能算法等高级算法学习、实现与分析

**贪吃蛇**

 贪吃蛇作为非常经典的一个小游戏，易于上手，操作简单，玩法可拓展性高。

本贪吃蛇分为两大模块，用户模式选择模块及游戏操作模块；其中游戏操作模块包含4种操作模式：1.普通模式，常规贪吃蛇规则，吃到一次食物，积分加一，身长加一，碰到墙/自身则游戏失败，吃完地图则胜利；2.穿墙模式，在普通模式的基础上，蛇可以穿越墙体而不会失败；3.无敌模式，在穿墙模式的基础上，蛇触碰自身不会失败，但是在无路可走时将判定失败。4.弱AI模式，遵循普通模式的规则，将用户操作完全替换为电脑控制，但目前还很蠢……

**2．** **设计**：

(1)数据结构设计和核心算法设计描述；

动态链表，ASTAR寻路算法，堆栈

**贪吃蛇动态链表结构：**

1. 将贪吃蛇设置为不带头结点的动态链表结构，每节蛇节点包含坐标及next指针。同时以链头为蛇头，链尾为蛇尾。

2. 对于蛇的移动，采用等待一定时间通过函数对各头结点根据移动方向进行坐标+1操作，对尾节点进行删除。

**ASTAR**寻路算法：

1.把起点加入 open list 。

2.重复如下过程：

a.遍历 open list ，查找 F 值最小的节点，作为当前要处理的节点。

b.把该节点移到 close list 。

c.对当前方格的 4 个相邻方格的每一个方格进行处理

*如果它是（不可抵达的或者）在 close list 中，则忽略。否则，做如下操作。

*如果它不在 open list 中，把它加入 open list ，并且把当前方格设置为它的双亲，记录该方格的 F ， G 和 H 值。（H值选用了曼哈顿距离）

*如果它已经在 open list 中，检查这条路径 ( 即经由当前方格到达它那里 ) 是否调整好，用 G 值作参考。更小的 G 值表示这是更好的路径。如果是，把它的双亲设置为当前方格，并重新计算它的 G 和 F 值。因为open list 是按 F 值排序，改变后需要重新排序。

d.完成上述步骤后，当

*把终点加入到了 open list 中，此时路径已经找到了，或

*查找终点失败，并且 open list 是空的，此时没有路径。

3.保存路径。从终点开始，每个方格沿着父节点移动直至起点回溯。

（在该算法中对open list的节点依据f值进行排序调整时，采用了堆栈结构及堆排序）

**3．** **测试**：

![img](https://gitee.com/yzketx/image-markdown/raw/master/img/202111271117854.png)

**开始界面**

![img](https://gitee.com/yzketx/image-markdown/raw/master/img/202111271117727.jpg)

**蛇撞到自己，游戏结束**

![img](https://gitee.com/yzketx/image-markdown/raw/master/img/202111271117043.jpg)

**蛇撞到墙，游戏结束**

![img](https://gitee.com/yzketx/image-markdown/raw/master/img/202111271119340.jpg)

**蛇可进行穿墙**

![img](https://gitee.com/yzketx/image-markdown/raw/master/img/202111271119387.jpg)

**蛇在无敌模式下无路可走**

![img](https://gitee.com/yzketx/image-markdown/raw/master/img/202111271119651.jpg)

**蛇速度10分一档增加**

![img](https://gitee.com/yzketx/image-markdown/raw/master/img/202111271119168.jpg)

**按ESC键强制退出**

![img](https://gitee.com/yzketx/image-markdown/raw/master/img/202111271119403.jpg)

**弱AI模式截图，此时已经无路可走了**

![img](https://gitee.com/yzketx/image-markdown/raw/master/img/202111271119937.jpg)

**4．** **使用说明和作业小结**：

(1) 贪吃蛇基本操作及说明：

用户操作方面，用户模式选择模块可以通过键盘上下方向键实现模式的循环切换，Enter键进入游戏，左方向键实现音乐的暂停，右方向键实现音乐的继续播放（音乐控制功能仅在该模块生效）；游戏操作模块，字母键 W,S,A,D / 方向键 ↑, ↓, ←, → 控制方向，Space为暂停，ESC为强制退出，长按方向键可加速（后三者功能对弱AI模式不适用）。

其中除弱AI模式外，贪吃蛇速度会随积分变化10分一档，0-9为1档，10-19为2档，…,70-79为8档，达到最快速度，结合此时蛇的长度考虑游戏体验，开始10分一档降速，直到降到4档不再变化。

注：当贪吃蛇吃到食物后，头会短暂呈现蛇尾颜色，尾会变为白色，并不是bug，可以很简单实现身子增长而头尾颜色不变，这里作此呈现是考虑到了对用户的一个反馈，可能效果不会很好，但个人认为这样比没有变化要好。

(2) 改进空间方面：更多的用户自定义；简易的用户管理（尝试过，但效果不太好，最后感觉也没什么用，就去了）及在此基础上的排行榜、蛇颜色兑换；多人模式，甚至局域网对战；换用qt；墙体数据结构的定义(非数组)，方便障碍物的生成；优化各功能函数逻辑，进一步拆分与整合，对实现形式进行改写；AI寻路算法的优化；等等等等。
